<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEVESOMO –®–∏—Ñ—Ç—ã 2025</title>
    <link rel="stylesheet" href="https://nevesomo.vercel.app/styles.min.css">

    <!-- Telegram Mini‚ÄëApp SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <!-- –õ–æ–∫–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –æ–≤–µ—Ä–ª–µ—è –¥–æ—Å—Ç—É–ø–∞ -->
    <style>
        .access-block {
            position: fixed;
            inset: 0;
            backdrop-filter: blur(6px);
            background: rgba(0, 0, 0, 0.45);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 5000;
            color: #fff;
            text-align: center;
            padding: 24px;
        }
        .access-block a {
            color: #2AABEE;
            text-decoration: underline;
        }
        .header-greeting {
            font-size: 0.9em;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <!-- –•–µ–¥–µ—Ä –≤ —Å—Ç–∏–ª–µ Telegram -->
    <div class="header">
        <div class="header-left">NEVESOMO</div>
        <div class="header-center">–®–ò–§–¢–´</div>
        <div class="header-right">
            <div id="userGreeting" class="header-greeting"></div>
            <button class="theme-toggle" onclick="toggleTheme()" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
                üåô
            </button>
            <div class="burger-btn" onclick="toggleMenu()">
                <div class="burger-menu">
                    <div class="burger-line"></div>
                    <div class="burger-line"></div>
                    <div class="burger-line"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div id="deadlineWarning" class="deadline-warning">
            <div>‚ö†Ô∏è –í—ã–±–µ—Ä–∏—Ç–µ —Å–µ–±–µ —à–∏—Ñ—Ç—ã –¥–æ 8 –∏—é–ª—è 2025 –≥–æ–¥–∞ –∏–ª–∏ –º—ã –≤—ã–±–µ—Ä–µ–º –∏—Ö –∑–∞ –≤–∞—Å</div>
            <div class="countdown" id="countdown"></div>
        </div>
        
        <div id="userSelector" class="user-selector" style="display:none;">
            <select id="currentUser" onchange="updateView()">
                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞</option>
            </select>
        </div>
        
        <div id="schedule"></div>
        
        <!-- –ö–Ω–æ–ø–∫–∞ –º–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞ -->
        <button id="myScheduleBtn" class="my-schedule-btn" onclick="openMySchedule()" style="display: none;">
            –ú–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ
        </button>
    </div>

    <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä -->
    <div id="progressBar" class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
    </div>
    <div id="progressText" class="progress-text"></div>

    <!-- –ú–µ–Ω—é -->
    <div class="menu-overlay" id="menuOverlay" onclick="closeMenu()">
        <div class="menu-content" onclick="event.stopPropagation()">
            <div class="menu-header">
                <div class="menu-title">–ú–µ–Ω—é</div>
                <button class="menu-close" onclick="closeMenu()">√ó</button>
            </div>
            <div id="menuItems"></div>
        </div>
    </div>

    <!-- –ü–æ–ø–∞–ø –¥–ª—è –≤—ã–±–æ—Ä–∞ —É—á–∞—Å—Ç–Ω–∏–∫–∞ (–∞–¥–º–∏–Ω) -->
    <div class="popup-overlay" id="participantPopup">
        <div class="popup-bottom" onclick="event.stopPropagation()">
            <div class="popup-header">
                <div class="popup-title">–í—ã–±–µ—Ä–∏—Ç–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞</div>
                <button class="popup-close" onclick="closeParticipantPopup()">√ó</button>
            </div>
            <div class="popup-body">
                <div id="participantsList"></div>
            </div>
        </div>
    </div>

    <!-- ‚Ä¶ (–æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ø–∞–ø—ã –∏ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ‚Ä¶ -->

    <!-- –û–≤–µ—Ä–ª–µ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –¥–æ—Å—Ç—É–ø–∞ -->
    <div id="accessOverlay" class="access-block" style="display:none;">
        <p style="font-size: 1.3em; margin-bottom: 8px;">üö´ –î–æ—Å—Ç—É–ø –∑–∞–∫—Ä—ã—Ç</p>
        <p>–û–±—Ä–∞—Ç–∏—Å—å –∫ –ª–∏–¥y —à–∏—Ñ—Ço–≤ <a href="https://t.me/konovalchik" target="_blank">@konovalchik</a></p>
    </div>

    <!-- Telegram init + –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ -->
    <script>
        const tg = window.Telegram?.WebApp;
        if (tg) {
            tg.ready();
            const user = tg.initDataUnsafe?.user;
            if (user) {
                // –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
                document.getElementById('userGreeting').textContent = `üëã ${user.first_name}`;
                // –î–µ–ª–∞–µ–º —Å–µ–ª–µ–∫—Ç–æ—Ä —É—á–∞—Å—Ç–Ω–∏–∫–∞ –Ω–µ–≤–∏–¥–∏–º—ã–º: —É—á–∞—Å—Ç–Ω–∏–∫ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
                document.getElementById('userSelector').style.display = 'none';
                // –ü–µ—Ä–µ–¥–∞—ë–º ID –∏ username –≤–æ –≤–Ω–µ—à–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç—ã
                window.tgUserId = user.id;
                window.tgUsername = user.username ? `@${user.username}` : '';
            }
        }
    </script>
    <script src="https://nevesomo.vercel.app/telegram.js"></script>
    <script src="https://nevesomo.vercel.app/airtable.js"></script>
    <script src="https://nevesomo.vercel.app/script.js"></script>
</body>
</html>

